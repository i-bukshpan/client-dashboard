# דוגמאות קוד מעשיות - Copy & Paste

דוגמאות קוד מוכנות לשימוש מיידי. העתק, הדבק ותקן לפי הצרכים שלך.

---

## 1. טעינת רשימה מהמסד

### טעינת לקוחות
```tsx
'use client'

import { useState, useEffect } from 'react'
import { supabase } from '@/lib/supabase'

export default function MyComponent() {
  const [clients, setClients] = useState([])
  const [loading, setLoading] = useState(true)
  
  useEffect(() => {
    loadClients()
  }, [])
  
  async function loadClients() {
    try {
      const { data, error } = await supabase
        .from('clients')
        .select('*')
        .order('created_at', { ascending: false })
      
      if (error) throw error
      setClients(data || [])
    } catch (error) {
      console.error('שגיאה:', error)
      alert('שגיאה בטעינת לקוחות')
    } finally {
      setLoading(false)
    }
  }
  
  if (loading) return <div>טוען...</div>
  
  return (
    <div>
      {clients.map(client => (
        <div key={client.id}>{client.name}</div>
      ))}
    </div>
  )
}
```

---

## 2. הוספת רשומה חדשה

### הוספת לקוח חדש
```tsx
'use client'

import { useState } from 'react'
import { supabase } from '@/lib/supabase'
import { Button } from '@/components/ui/button'
import { Input } from '@/components/ui/input'

export function AddClientForm() {
  const [name, setName] = useState('')
  const [email, setEmail] = useState('')
  const [phone, setPhone] = useState('')
  const [loading, setLoading] = useState(false)
  
  async function handleSubmit(e) {
    e.preventDefault()
    setLoading(true)
    
    try {
      const { data, error } = await supabase
        .from('clients')
        .insert([{
          name,
          email: email || null,
          phone: phone || null,
          status: 'פעיל'
        }])
        .select()
        .single()
      
      if (error) throw error
      
      alert('הלקוח נוסף בהצלחה!')
      setName('')
      setEmail('')
      setPhone('')
    } catch (error) {
      console.error('שגיאה:', error)
      alert('שגיאה בהוספת לקוח: ' + error.message)
    } finally {
      setLoading(false)
    }
  }
  
  return (
    <form onSubmit={handleSubmit}>
      <Input
        placeholder="שם"
        value={name}
        onChange={(e) => setName(e.target.value)}
        required
      />
      <Input
        placeholder="אימייל"
        type="email"
        value={email}
        onChange={(e) => setEmail(e.target.value)}
      />
      <Input
        placeholder="טלפון"
        value={phone}
        onChange={(e) => setPhone(e.target.value)}
      />
      <Button type="submit" disabled={loading}>
        {loading ? 'שומר...' : 'שמור'}
      </Button>
    </form>
  )
}
```

---

## 3. עריכת רשומה

### עריכת לקוח קיים
```tsx
'use client'

import { useState, useEffect } from 'react'
import { supabase } from '@/lib/supabase'
import { Button } from '@/components/ui/button'
import { Input } from '@/components/ui/input'

export function EditClientForm({ clientId, onSuccess }) {
  const [name, setName] = useState('')
  const [email, setEmail] = useState('')
  const [loading, setLoading] = useState(false)
  
  useEffect(() => {
    loadClient()
  }, [clientId])
  
  async function loadClient() {
    const { data } = await supabase
      .from('clients')
      .select('*')
      .eq('id', clientId)
      .single()
    
    if (data) {
      setName(data.name || '')
      setEmail(data.email || '')
    }
  }
  
  async function handleSubmit(e) {
    e.preventDefault()
    setLoading(true)
    
    try {
      const { error } = await supabase
        .from('clients')
        .update({ name, email })
        .eq('id', clientId)
      
      if (error) throw error
      
      alert('הלקוח עודכן בהצלחה!')
      if (onSuccess) onSuccess()
    } catch (error) {
      alert('שגיאה: ' + error.message)
    } finally {
      setLoading(false)
    }
  }
  
  return (
    <form onSubmit={handleSubmit}>
      <Input value={name} onChange={(e) => setName(e.target.value)} />
      <Input value={email} onChange={(e) => setEmail(e.target.value)} />
      <Button type="submit" disabled={loading}>
        עדכן
      </Button>
    </form>
  )
}
```

---

## 4. מחיקת רשומה

### מחיקת לקוח
```tsx
async function deleteClient(clientId: string) {
  if (!confirm('האם אתה בטוח שברצונך למחוק את הלקוח?')) {
    return
  }
  
  try {
    const { error } = await supabase
      .from('clients')
      .delete()
      .eq('id', clientId)
    
    if (error) throw error
    
    alert('הלקוח נמחק בהצלחה')
    // רענון הרשימה
    loadClients()
  } catch (error) {
    alert('שגיאה במחיקה: ' + error.message)
  }
}
```

---

## 5. חיפוש וסינון

### חיפוש לקוחות
```tsx
'use client'

import { useState, useEffect } from 'react'
import { supabase } from '@/lib/supabase'
import { Input } from '@/components/ui/input'

export function ClientSearch() {
  const [searchTerm, setSearchTerm] = useState('')
  const [clients, setClients] = useState([])
  
  useEffect(() => {
    if (searchTerm.length > 0) {
      searchClients()
    } else {
      setClients([])
    }
  }, [searchTerm])
  
  async function searchClients() {
    const { data } = await supabase
      .from('clients')
      .select('*')
      .or(`name.ilike.%${searchTerm}%,email.ilike.%${searchTerm}%,phone.ilike.%${searchTerm}%`)
      .limit(10)
    
    setClients(data || [])
  }
  
  return (
    <div>
      <Input
        placeholder="חפש לקוח..."
        value={searchTerm}
        onChange={(e) => setSearchTerm(e.target.value)}
      />
      <div>
        {clients.map(client => (
          <div key={client.id}>{client.name}</div>
        ))}
      </div>
    </div>
  )
}
```

### סינון לפי סטטוס
```tsx
const [statusFilter, setStatusFilter] = useState('הכל')
const [clients, setClients] = useState([])

async function loadClients() {
  let query = supabase
    .from('clients')
    .select('*')
  
  if (statusFilter !== 'הכל') {
    query = query.eq('status', statusFilter)
  }
  
  const { data } = await query.order('created_at', { ascending: false })
  setClients(data || [])
}
```

---

## 6. טבלה עם נתונים

### טבלה פשוטה
```tsx
'use client'

import { useState, useEffect } from 'react'
import { supabase } from '@/lib/supabase'

export function ClientsTable() {
  const [clients, setClients] = useState([])
  
  useEffect(() => {
    loadClients()
  }, [])
  
  async function loadClients() {
    const { data } = await supabase
      .from('clients')
      .select('*')
      .order('created_at', { ascending: false })
    
    setClients(data || [])
  }
  
  return (
    <table className="w-full border-collapse">
      <thead>
        <tr>
          <th className="border p-2">שם</th>
          <th className="border p-2">אימייל</th>
          <th className="border p-2">טלפון</th>
          <th className="border p-2">סטטוס</th>
        </tr>
      </thead>
      <tbody>
        {clients.map(client => (
          <tr key={client.id}>
            <td className="border p-2">{client.name}</td>
            <td className="border p-2">{client.email || '-'}</td>
            <td className="border p-2">{client.phone || '-'}</td>
            <td className="border p-2">{client.status || '-'}</td>
          </tr>
        ))}
      </tbody>
    </table>
  )
}
```

---

## 7. חלון דיאלוג (Modal)

### שימוש בקומפוננטת Dialog קיימת
```tsx
'use client'

import { useState } from 'react'
import { Dialog, DialogContent, DialogHeader, DialogTitle, DialogTrigger } from '@/components/ui/dialog'
import { Button } from '@/components/ui/button'

export function MyDialog() {
  const [open, setOpen] = useState(false)
  
  return (
    <Dialog open={open} onOpenChange={setOpen}>
      <DialogTrigger asChild>
        <Button>פתח חלון</Button>
      </DialogTrigger>
      <DialogContent>
        <DialogHeader>
          <DialogTitle>כותרת החלון</DialogTitle>
        </DialogHeader>
        <div>
          תוכן החלון כאן
        </div>
      </DialogContent>
    </Dialog>
  )
}
```

---

## 8. Server Action

### יצירת Server Action
```tsx
// lib/actions/my-actions.ts
'use server'

import { supabase } from '@/lib/supabase'

export async function myAction(param1: string, param2: number) {
  try {
    const { data, error } = await supabase
      .from('clients')
      .select('*')
      .eq('id', param1)
    
    if (error) {
      return { success: false, error: error.message }
    }
    
    return { success: true, data }
  } catch (error) {
    return { success: false, error: 'שגיאה לא צפויה' }
  }
}
```

### שימוש ב-Server Action
```tsx
'use client'

import { myAction } from '@/lib/actions/my-actions'

async function handleClick() {
  const result = await myAction('123', 456)
  
  if (result.success) {
    console.log('הצלחה:', result.data)
  } else {
    alert('שגיאה: ' + result.error)
  }
}
```

---

## 9. טעינה עם Loading State

### Loading Spinner
```tsx
'use client'

import { useState } from 'react'

export function MyComponent() {
  const [loading, setLoading] = useState(false)
  const [data, setData] = useState(null)
  
  async function loadData() {
    setLoading(true)
    try {
      // כאן הקוד שלך
      await new Promise(resolve => setTimeout(resolve, 1000)) // סימולציה
      setData('נתונים')
    } finally {
      setLoading(false)
    }
  }
  
  if (loading) {
    return <div>טוען...</div>
  }
  
  return (
    <div>
      {data && <div>{data}</div>}
      <button onClick={loadData}>טען</button>
    </div>
  )
}
```

---

## 10. טיפול בשגיאות

### Try-Catch עם הודעות משתמש
```tsx
async function myFunction() {
  try {
    const { data, error } = await supabase
      .from('clients')
      .select('*')
    
    if (error) {
      throw new Error(error.message)
    }
    
    // המשך עם data
    return data
  } catch (error) {
    console.error('שגיאה בפונקציה:', error)
    
    // הודעה למשתמש
    const message = error instanceof Error 
      ? error.message 
      : 'שגיאה לא ידועה'
    
    alert('שגיאה: ' + message)
    
    // אפשר גם להחזיר null או ערך ברירת מחדל
    return null
  }
}
```

---

## 11. Form Validation

### ולידציה בסיסית
```tsx
'use client'

import { useState } from 'react'

export function ValidatedForm() {
  const [email, setEmail] = useState('')
  const [errors, setErrors] = useState({})
  
  function validate() {
    const newErrors = {}
    
    if (!email) {
      newErrors.email = 'נדרש למלא אימייל'
    } else if (!email.includes('@')) {
      newErrors.email = 'אימייל לא תקין'
    }
    
    setErrors(newErrors)
    return Object.keys(newErrors).length === 0
  }
  
  function handleSubmit(e) {
    e.preventDefault()
    
    if (validate()) {
      // המשך עם השליחה
      console.log('הטופס תקין')
    }
  }
  
  return (
    <form onSubmit={handleSubmit}>
      <input
        value={email}
        onChange={(e) => setEmail(e.target.value)}
      />
      {errors.email && <div className="text-red-500">{errors.email}</div>}
      <button type="submit">שלח</button>
    </form>
  )
}
```

---

## 12. Date Formatting

### פורמט תאריך
```tsx
import { format } from 'date-fns'
import { he } from 'date-fns/locale'

// פורמט תאריך עברי
const dateStr = format(new Date('2024-01-15'), 'dd/MM/yyyy', { locale: he })

// או עם זמן
const dateTimeStr = format(new Date(), 'dd/MM/yyyy HH:mm', { locale: he })
```

---

## 13. Conditional Rendering

### הצגה מותנית
```tsx
// אם-אז
{isLoggedIn ? (
  <div>מחובר</div>
) : (
  <div>לא מחובר</div>
)}

// אם בלבד
{data && <div>{data.name}</div>}

// אם לא
{!loading && <div>טעינה הושלמה</div>}

// switch case
{status === 'active' && <div>פעיל</div>}
{status === 'inactive' && <div>לא פעיל</div>}
{status === 'pending' && <div>ממתין</div>}
```

---

## 14. Lists & Maps

### רשימה עם map
```tsx
const items = ['א', 'ב', 'ג']

return (
  <ul>
    {items.map((item, index) => (
      <li key={index}>{item}</li>
    ))}
  </ul>
)
```

### רשימה עם פילטר
```tsx
const activeClients = clients.filter(client => client.status === 'פעיל')

return (
  <div>
    {activeClients.map(client => (
      <div key={client.id}>{client.name}</div>
    ))}
  </div>
)
```

---

## 15. Navigation

### קישור לדף אחר
```tsx
import Link from 'next/link'

// קישור פשוט
<Link href="/clients/123">עבור ללקוח</Link>

// קישור עם כפתור
<Link href="/clients/123">
  <Button>עבור ללקוח</Button>
</Link>
```

### ניתוב דינמי
```tsx
import { useRouter } from 'next/navigation'

const router = useRouter()

function goToClient(id: string) {
  router.push(`/clients/${id}`)
}

// שימוש
<button onClick={() => goToClient('123')}>
  עבור ללקוח
</button>
```

---

## 16. Local Storage

### שמירה ב-LocalStorage
```tsx
'use client'

import { useState, useEffect } from 'react'

export function UseLocalStorage() {
  const [value, setValue] = useState('')
  
  // טעינה מהמקומי
  useEffect(() => {
    const stored = localStorage.getItem('myKey')
    if (stored) {
      setValue(stored)
    }
  }, [])
  
  // שמירה למקומי
  function handleChange(newValue: string) {
    setValue(newValue)
    localStorage.setItem('myKey', newValue)
  }
  
  return (
    <input
      value={value}
      onChange={(e) => handleChange(e.target.value)}
    />
  )
}
```

---

## 17. Debounce (השהיה)

### חיפוש עם השהיה
```tsx
'use client'

import { useState, useEffect } from 'react'

export function DebouncedSearch() {
  const [searchTerm, setSearchTerm] = useState('')
  const [results, setResults] = useState([])
  
  useEffect(() => {
    const timer = setTimeout(() => {
      if (searchTerm) {
        // ביצוע החיפוש
        performSearch(searchTerm)
      }
    }, 500) // המתן 500ms אחרי שהמשתמש הפסיק להקליד
    
    return () => clearTimeout(timer)
  }, [searchTerm])
  
  async function performSearch(term: string) {
    // קוד חיפוש כאן
  }
  
  return (
    <input
      value={searchTerm}
      onChange={(e) => setSearchTerm(e.target.value)}
      placeholder="חפש..."
    />
  )
}
```

---

## 18. Copy to Clipboard

### העתקה ללוח
```tsx
function copyToClipboard(text: string) {
  navigator.clipboard.writeText(text).then(() => {
    alert('הועתק ללוח!')
  }).catch(err => {
    alert('שגיאה בהעתקה')
  })
}

// שימוש
<button onClick={() => copyToClipboard('טקסט להעתקה')}>
  העתק
</button>
```

---

## 19. File Download

### הורדת קובץ
```tsx
function downloadFile(data: string, filename: string) {
  const blob = new Blob([data], { type: 'text/plain' })
  const url = URL.createObjectURL(blob)
  const link = document.createElement('a')
  link.href = url
  link.download = filename
  link.click()
  URL.revokeObjectURL(url)
}

// שימוש
<button onClick={() => downloadFile('תוכן', 'קובץ.txt')}>
  הורד
</button>
```

---

## 20. Toast Notifications

### הודעות Toast (אם יש קומפוננטת Toast)
```tsx
import { useToast } from '@/components/ui/use-toast'

export function MyComponent() {
  const { toast } = useToast()
  
  function showSuccess() {
    toast({
      title: 'הצלחה!',
      description: 'הפעולה בוצעה בהצלחה',
    })
  }
  
  function showError() {
    toast({
      title: 'שגיאה',
      description: 'משהו השתבש',
      variant: 'destructive',
    })
  }
  
  return (
    <div>
      <button onClick={showSuccess}>הצג הצלחה</button>
      <button onClick={showError}>הצג שגיאה</button>
    </div>
  )
}
```

---

**טיפ:** העתק את הדוגמאות שאתה צריך, הדבק בקובץ שלך ותקן לפי הצרכים הספציפיים שלך!
